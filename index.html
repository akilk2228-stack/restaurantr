<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Restaurant QR Order</title>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <style>
    body { font-family: Arial; margin: 0; padding: 0; }
    header { background: #b71c1c; color: white; padding: 15px; font-size: 20px; }
    .box { padding: 15px; }
    .item {
      border-bottom: 1px solid #ddd;
      padding: 10px 0;
    }
    button {
      padding: 6px 10px;
      margin-left: 10px;
    }
    #total {
      font-size: 18px;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<header>üçΩ Restaurant QR Order</header>

<div class="box">
  <b>Table:</b> <span id="tableNo"></span><br><br>

  <input id="custName" placeholder="Your Name" style="width:100%;padding:8px;"><br><br>

  <h3>Menu</h3>
  <div id="menu"></div>

  <div id="total">Total: ‚Çπ0</div><br>

  <button onclick="placeOrder()">Order Place</button>
</div>

<script>
  // üî• Firebase Config (tumhara)
  const firebaseConfig = {
    apiKey: "AIzaSyCgaZ9DqGuszvycCRuJceNvg7G86OTc9oU",
    authDomain: "restaurant-55333.firebaseapp.com",
    projectId: "restaurant-55333",
    storageBucket: "restaurant-55333.firebasestorage.app",
    messagingSenderId: "279347685173",
    appId: "1:279347685173:web:cb1a120e25e3adb856ce7c"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  // üìå Table detect from QR
  const params = new URLSearchParams(window.location.search);
  const table = params.get("table") || "N/A";
  document.getElementById("tableNo").innerText = table;

  let cart = [];
  let total = 0;

  // üìå Load Menu
  db.collection("menu")
    .where("available", "==", true)
    .onSnapshot(snapshot => {
      const menuDiv = document.getElementById("menu");
      menuDiv.innerHTML = "";

      snapshot.forEach(doc => {
        const d = doc.data();
        menuDiv.innerHTML += `
          <div class="item">
            ${d.name} - ‚Çπ${d.price}
            <button onclick="addItem('${d.name}', ${d.price})">Add</button>
          </div>
        `;
      });
    });

  function addItem(name, price) {
    cart.push({ name, price });
    total += price;
    document.getElementById("total").innerText = "Total: ‚Çπ" + total;
  }

  function placeOrder() {
    const name = document.getElementById("custName").value;
    if (!name || cart.length === 0) {
      alert("Name or items missing");
      return;
    }

    db.collection("orders").add({
      table: table,
      customer: name,
      items: cart,
      total: total,
      status: "pending",
      time: new Date()
    });

    alert("Order placed successfully!");
    cart = [];
    total = 0;
    document.getElementById("total").innerText = "Total: ‚Çπ0";
  }
</script>

</body>
</html>

